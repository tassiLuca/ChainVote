<!DOCTYPE html>
<html>    
    <head>
        <%- include('commons/head') %>
        <link rel="stylesheet" href="../styles/personal-area.css">
    </head>
    <body>
        <%- include('commons/navbar') %>
        <main>
            <div class="row justify-content-center">
                <h1 id="electionName">Election id / name</h1>
            </div>
            <div class="row" id="content">
                <div class="col-md-5 center mx-auto">
                    <h2 id="question">Who do you want to be the next rector of UniBo?</h2>
                    <form action="" method="post">
                        <button type="button" class="btn btn-outline-primary btn-block">Request my one time code</button>
                    </form>
                    <p>To adjust here depending on API :)</p>
                    <form id="voteForm" action="" method="post">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">One time code</span>
                            </div>
                            <input type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="option1" />
                            <label class="form-check-label" for="exampleRadios1">Option 1</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="option2" />
                            <label class="form-check-label" for="exampleRadios2">Option 2</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios3" value="option3" />
                            <label class="form-check-label" for="exampleRadios3">Option 3</label>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-block" onclick="sendVote()">Send your vote</button>
                    </form>
                </div>
            </div>
        </main>
        <%- include('commons/footer') %>
        <script>
            function sendVote() {
                const oneTimeCode = document.querySelector('#voteForm input[type="text"]').value;
                const selectedOption = document.querySelector('#voteForm input[name="exampleRadios"]:checked');

                if (!oneTimeCode || !selectedOption) {
                    alert('Please fill in all fields');
                    return;
                }

                const data = {
                    oneTimeCode: oneTimeCode,
                    selectedOption: selectedOption.value,
                };

                // Replace 'http://localhost:3000/cast-vote' with your actual endpoint
                axios.post('http://localhost:3000/cast-vote', data)
                    .then(response => {
                        // Handle success, e.g., show a success message
                        console.log(response.data);
                        alert('Vote submitted successfully!');
                    })
                    .catch(error => {
                        // Handle error, e.g., show an error message
                        console.error('Error submitting vote:', error);
                        alert('Error submitting vote. Please try again.');
                    });
            }
        </script>
    </body>
</html>